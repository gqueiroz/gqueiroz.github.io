<!DOCTYPE html>
<html class="writer-html5" lang="pt-BR" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>6.7. Carregando Dados no Formato JSON &mdash; BDGeo</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="../_static/tabs.css" type="text/css" />
      <link rel="stylesheet" href="../_static/table_styling.css" type="text/css" />
      <link rel="stylesheet" href="../_static/bd-geoespacial.css" type="text/css" />
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="canonical" href="https://prog-geo.github.io/json/carga-dados.html" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
        <script src="../_static/clipboard.min.js"></script>
        <script src="../_static/copybutton.js"></script>
        <script src="../_static/translations.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Índice" href="../genindex.html" />
    <link rel="search" title="Buscar" href="../search.html" />
    <link rel="next" title="7. Programação do Lado Servidor no PostgreSQL" href="../prog-servidor/index.html" />
    <link rel="prev" title="6.6. O Tipo JSON no PostgreSQL" href="json.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #F0F8FF" >
            <a href="../index.html" class="icon icon-home"> BDGeo
            <img src="../_static/logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Pesquisar documentos" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Menu de navegação">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../index.html">Bancos de Dados Geográficos</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Aulas:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../instalacao/index.html">1. Instalando e Configurando o Ambiente de Trabalho</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sgbd/index.html">2. Sistemas de Bancos de Dados Relacionais</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tipos-geometricos/index.html">3. Tipos de Dados e Operações Espaciais</a></li>
<li class="toctree-l1"><a class="reference internal" href="../estrutura-dados/index.html">4. Estruturas de Dados e Métodos de Acesso Multidimensionais</a></li>
<li class="toctree-l1"><a class="reference internal" href="../algo-geom/index.html">5. Algoritmos Geométricos</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">6. JSON (Java Script Object Notation)</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="introducao.html">6.1. Documentos JSON</a></li>
<li class="toctree-l2"><a class="reference internal" href="sintaxe.html">6.2. Sintaxe de Documentos JSON</a></li>
<li class="toctree-l2"><a class="reference internal" href="validadores.html">6.3. Validadores de Documentos JSON</a></li>
<li class="toctree-l2"><a class="reference internal" href="python.html">6.4. Leitura e Escrita de Arquivos JSON em Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="geojson.html">6.5. Documentos GeoJSON</a></li>
<li class="toctree-l2"><a class="reference internal" href="json.html">6.6. O Tipo JSON no PostgreSQL</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">6.7. Carregando Dados no Formato JSON</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#usando-indices-gin-com-o-tipo-jsonb">6.7.1. Usando índices GIN com o tipo <code class="docutils literal notranslate"><span class="pre">jsonb</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#dicas">6.7.2. Dicas</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../prog-servidor/index.html">7. Programação do Lado Servidor no PostgreSQL</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tips/index.html">8. Dicas</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Referências Bibliográficas</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../referencias.html">Referências Bibliográficas</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Listas de Exercícios:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../listas.html">Listas de Exercícios</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Informações Gerais:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../licenca.html">Licença</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Agradecimentos:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../agradecimentos.html">Agradecimentos</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Menu de navegação móvel"  style="background: #F0F8FF" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">BDGeo</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content style-external-links">
          <div role="navigation" aria-label="Navegação da página">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="index.html"><span class="section-number">6. </span>JSON (Java Script Object Notation)</a> &raquo;</li>
      <li><span class="section-number">6.7. </span>Carregando Dados no Formato JSON</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul><div class="rst-breadcrumbs-buttons" role="navigation" aria-label="Navegação sequencial da página">
        <a href="json.html" class="btn btn-neutral float-left" title="6.6. O Tipo JSON no PostgreSQL" accesskey="p"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Anterior</a>
        <a href="../prog-servidor/index.html" class="btn btn-neutral float-right" title="7. Programação do Lado Servidor no PostgreSQL" accesskey="n">Próximo <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
  </div>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="carregando-dados-no-formato-json">
<span id="cap-json-carga-dados"></span><h1><span class="section-number">6.7. </span>Carregando Dados no Formato JSON<a class="headerlink" href="#carregando-dados-no-formato-json" title="Link permanente para este cabeçalho"></a></h1>
<p>O comando <code class="docutils literal notranslate"><span class="pre">COPY</span></code> do servidor PostgreSQL, assim como o metacomando <code class="docutils literal notranslate"><span class="pre">\copy</span></code>  do <em>psql</em>, não suportam diretamente a importação de dados no formato JSON. Como vimos na <a class="reference internal" href="../sgbd/import-export.html#cap-sgbd-import-export"><span class="std std-numref">Seção 2.22 - Importando e Exportando Dados</span></a>, esses comandos podem trabalhar diretamente com os formatos CSV, texto e binário. No entanto, esses comandos possuem uma forma de especificar a conexão com programas externos para leitura ou escrita de dados. Neste caso, é possível utilizar a forma <code class="docutils literal notranslate"><span class="pre">FROM</span> <span class="pre">PROGRAM</span></code> desses comandos para especificar que a leitura ou escrita de dados deverá interagir com um programa auxiliar.</p>
<p>Para ajudar no processo de carga de dados no formato JSON iremos utilizar uma ferramenta de linha de comando chamada <a class="reference external" href="https://stedolan.github.io/jq/">jq</a>, que é um processador de dados estruturados em JSON que pode ser facilmente utilizado com os comandos <code class="docutils literal notranslate"><span class="pre">COPY</span></code> do PostgreSQL ou o metacomando <code class="docutils literal notranslate"><span class="pre">\copy</span></code> do <em>psql</em>, usando a forma <code class="docutils literal notranslate"><span class="pre">FROM</span> <span class="pre">PROGRAM</span></code> desses dois comandos. Esse processador irá permitir realizar as transformações necessárias no dado de entrada para que ele possa ser inserido em tabelas do PostgreSQL.</p>
<p>Os dados que usaremos nessa seção são derivados do arquivo usado na <a class="reference internal" href="../tipos-geometricos/consultas-espaciais/spatial-join.html#cap-tipos-geometricos-consultas-espaciais-spatial-join-focos-2020"><span class="std std-numref">Seção 3.5.5.4</span></a> e, contém uma seleção de 2.283 focos de calor na vegetação codificados em um arquivo JSON. O conteúdo do arquivo <a class="reference download internal" download="" href="../_downloads/6a7692f3ff72ffcd93a18ed8855210ba/focos.json"><code class="xref download docutils literal notranslate"><span class="pre">focos.json</span></code></a> é mostrado parcialmente abaixo:</p>
<div class="literal-block-wrapper docutils container" id="id1">
<div class="code-block-caption"><span class="caption-number">Trecho de Código 6.6 - </span><span class="caption-text">Arquivo <a class="reference download internal" download="" href="../_downloads/6a7692f3ff72ffcd93a18ed8855210ba/focos.json"><code class="xref download docutils literal notranslate"><span class="pre">focos.json</span></code></a>.</span><a class="headerlink" href="#id1" title="Link Permanente para esse código"></a></div>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="w"></span>
<span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;FeatureCollection&quot;</span><span class="p">,</span><span class="w"></span>
<span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;focos&quot;</span><span class="p">,</span><span class="w"></span>
<span class="nt">&quot;features&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<span class="p">{</span><span class="w"> </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Feature&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;properties&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;gid&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">247</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;datahora&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2020-01-01 16:45:00&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;satelite&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;AQUA_M-T&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;pais&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Brasil&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;estado&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;MATO GROSSO DO SUL&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;municipio&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;AMAMBAI&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;bioma&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Mata Atlantica&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;diasemchuv&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;precipitac&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;riscofogo&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;latitude&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">-23.17</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;longitude&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">-54.732</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;frp&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">46.2</span><span class="w"> </span><span class="p">},</span><span class="w"> </span><span class="nt">&quot;geometry&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Point&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;coordinates&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="mf">-54.732</span><span class="p">,</span><span class="w"> </span><span class="mf">-23.17</span><span class="w"> </span><span class="p">]</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">},</span><span class="w"></span>
<span class="p">{</span><span class="w"> </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Feature&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;properties&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;gid&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">248</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;datahora&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2020-01-01 16:45:00&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;satelite&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;AQUA_M-T&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;pais&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Brasil&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;estado&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;MATO GROSSO DO SUL&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;municipio&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;AMAMBAI&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;bioma&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Mata Atlantica&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;diasemchuv&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;precipitac&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;riscofogo&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;latitude&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">-23.176</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;longitude&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">-54.727</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;frp&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">44.3</span><span class="w"> </span><span class="p">},</span><span class="w"> </span><span class="nt">&quot;geometry&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Point&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;coordinates&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="mf">-54.727</span><span class="p">,</span><span class="w"> </span><span class="mf">-23.176</span><span class="w"> </span><span class="p">]</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">},</span><span class="w"></span>
<span class="p">{</span><span class="w"> </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Feature&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;properties&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;gid&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">249</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;datahora&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2020-01-01 16:45:00&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;satelite&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;AQUA_M-T&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;pais&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Brasil&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;estado&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;SAO PAULO&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;municipio&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;SAO ROQUE&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;bioma&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Mata Atlantica&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;diasemchuv&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;precipitac&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;riscofogo&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;latitude&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">-23.487</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;longitude&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">-47.109</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;frp&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">7.0</span><span class="w"> </span><span class="p">},</span><span class="w"> </span><span class="nt">&quot;geometry&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Point&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;coordinates&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="mf">-47.109</span><span class="p">,</span><span class="w"> </span><span class="mf">-23.487</span><span class="w"> </span><span class="p">]</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">},</span><span class="w"></span>
<span class="p">{</span><span class="w"> </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Feature&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;properties&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;gid&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">250</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;datahora&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2020-01-01 16:45:00&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;satelite&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;AQUA_M-T&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;pais&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Brasil&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;estado&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;PARANA&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;municipio&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;CAMPO LARGO&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;bioma&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Mata Atlantica&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;diasemchuv&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;precipitac&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;riscofogo&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;latitude&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">-25.383</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;longitude&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">-49.647</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;frp&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">26.2</span><span class="w"> </span><span class="p">},</span><span class="w"> </span><span class="nt">&quot;geometry&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Point&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;coordinates&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="mf">-49.647</span><span class="p">,</span><span class="w"> </span><span class="mf">-25.383</span><span class="w"> </span><span class="p">]</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">},</span><span class="w"></span>
</pre></div>
</div>
</div>
<p>Repare que o documento mostrado acima contém um objeto, com três pares <em>chave-valor</em>. Os focos estão codificados como elementos do <em>array</em> de chave <code class="docutils literal notranslate"><span class="pre">features</span></code>. Nosso objetivo será criar uma tabela com uma única coluna do tipo <code class="docutils literal notranslate"><span class="pre">JSONB</span></code> e importar cada um dos itens do array da chave <code class="docutils literal notranslate"><span class="pre">&quot;features&quot;</span></code> para uma linha dessa tabela.</p>
<p>A ferramenta <em>jq</em> permite que realizemos vários processamentos interessantes sobre documentos JSON. Na linha de comando do Linux, ou do macOS ou do Windows, podemos utilizar o comando <em>jq</em> para ler o conteúdo do arquivo acima, da seguinte forma:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>jq &lt; focos.json
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>No Microsoft Windows o aplicativo <em>jq</em> terá o nome <strong>jq-win64.exe</strong>. Como sugestão, baixe este aplicativo e o arquivo JSON do exemplo para uma pasta, como <code class="docutils literal notranslate"><span class="pre">C:\temp</span></code>.</p>
</div>
<p>Esse comando fará com que o arquivo <code class="docutils literal notranslate"><span class="pre">focos.json</span></code> seja lido e então escrito na saída padrão, isto é, na tela do terminal de comandos. Esse comando produzirá um saída formatada, como mostrado na saída parcial abaixo:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>{
  &quot;type&quot;: &quot;FeatureCollection&quot;,
  &quot;name&quot;: &quot;focos&quot;,
  &quot;features&quot;: [
    {
      &quot;type&quot;: &quot;Feature&quot;,
      &quot;properties&quot;: {
        &quot;gid&quot;: 247,
        &quot;datahora&quot;: &quot;2020-01-01 16:45:00&quot;,
        &quot;satelite&quot;: &quot;AQUA_M-T&quot;,
        &quot;pais&quot;: &quot;Brasil&quot;,
        &quot;estado&quot;: &quot;MATO GROSSO DO SUL&quot;,
        &quot;municipio&quot;: &quot;AMAMBAI&quot;,
        &quot;bioma&quot;: &quot;Mata Atlantica&quot;,
        &quot;diasemchuv&quot;: 0,
        &quot;precipitac&quot;: 0,
        &quot;riscofogo&quot;: 0,
        &quot;latitude&quot;: -23.17,
        &quot;longitude&quot;: -54.732,
        &quot;frp&quot;: 46.2
      },
      ...
</pre></div>
</div>
<p>Essa saída, assim como a forma original do arquivo não se encontram estruturadas para importação direta para o banco de dados. Queremos realizar um processamento no arquivo <code class="docutils literal notranslate"><span class="pre">focos.json</span></code> de maneira a produzir uma linha de texto para cada objeto que represente um foco. Para isso, será preciso extrair parte do conteúdo do documento de entrada e garantir que os objetos sejam reportados em uma única linha. No comando anterior, se acrescentarmos uma expressão de filtro como <code class="docutils literal notranslate"><span class="pre">'.features[]'</span></code>, teremos cada elemento do <em>array</em> <code class="docutils literal notranslate"><span class="pre">features</span></code> reportado separadamente:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>jq <span class="s1">&#39;.features[]&#39;</span> &lt; focos.json
</pre></div>
</div>
<p>Saída (parcial):</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>{
  &quot;type&quot;: &quot;Feature&quot;,
  &quot;properties&quot;: {
    &quot;gid&quot;: 247,
    &quot;datahora&quot;: &quot;2020-01-01 16:45:00&quot;,
    &quot;satelite&quot;: &quot;AQUA_M-T&quot;,
    &quot;pais&quot;: &quot;Brasil&quot;,
    &quot;estado&quot;: &quot;MATO GROSSO DO SUL&quot;,
    &quot;municipio&quot;: &quot;AMAMBAI&quot;,
    &quot;bioma&quot;: &quot;Mata Atlantica&quot;,
    &quot;diasemchuv&quot;: 0,
    &quot;precipitac&quot;: 0,
    &quot;riscofogo&quot;: 0,
    &quot;latitude&quot;: -23.17,
    &quot;longitude&quot;: -54.732,
    &quot;frp&quot;: 46.2
  },
  &quot;geometry&quot;: {
    &quot;type&quot;: &quot;Point&quot;,
    &quot;coordinates&quot;: [
      -54.732,
      -23.17
    ]
  }
}
{
  &quot;type&quot;: &quot;Feature&quot;,
  &quot;properties&quot;: {
    &quot;gid&quot;: 248,
    &quot;datahora&quot;: &quot;2020-01-01 16:45:00&quot;,
    &quot;satelite&quot;: &quot;AQUA_M-T&quot;,
    &quot;pais&quot;: &quot;Brasil&quot;,
    &quot;estado&quot;: &quot;MATO GROSSO DO SUL&quot;,
    &quot;municipio&quot;: &quot;AMAMBAI&quot;,
    &quot;bioma&quot;: &quot;Mata Atlantica&quot;,
    &quot;diasemchuv&quot;: 0,
    &quot;precipitac&quot;: 0,
    &quot;riscofogo&quot;: 0,
    &quot;latitude&quot;: -23.176,
    &quot;longitude&quot;: -54.727,
    &quot;frp&quot;: 44.3
  },
  &quot;geometry&quot;: {
    &quot;type&quot;: &quot;Point&quot;,
    &quot;coordinates&quot;: [
      -54.727,
      -23.176
    ]
  }
}
...
</pre></div>
</div>
<p>Agora, tudo que precisamos é que cada objeto representando um foco seja reportado em uma única linha de texto. As opções <code class="docutils literal notranslate"><span class="pre">-r</span></code> e <code class="docutils literal notranslate"><span class="pre">-c</span></code> nos darão esse resultado:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>jq -r -c <span class="s1">&#39;.features[]&#39;</span> &lt; focos.json
</pre></div>
</div>
<p>Saída (parcial):</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>{&quot;type&quot;:&quot;Feature&quot;,&quot;properties&quot;:{&quot;gid&quot;:247,&quot;datahora&quot;:&quot;2020-01-01 16:45:00&quot;,&quot;satelite&quot;:&quot;AQUA_M-T&quot;,&quot;pais&quot;:&quot;Brasil&quot;,&quot;estado&quot;:&quot;MATO GROSSO DO SUL&quot;,&quot;municipio&quot;:&quot;AMAMBAI&quot;,&quot;bioma&quot;:&quot;Mata Atlantica&quot;,&quot;diasemchuv&quot;:0,&quot;precipitac&quot;:0,&quot;riscofogo&quot;:0,&quot;latitude&quot;:-23.17,&quot;longitude&quot;:-54.732,&quot;frp&quot;:46.2},&quot;geometry&quot;:{&quot;type&quot;:&quot;Point&quot;,&quot;coordinates&quot;:[-54.732,-23.17]}}
{&quot;type&quot;:&quot;Feature&quot;,&quot;properties&quot;:{&quot;gid&quot;:248,&quot;datahora&quot;:&quot;2020-01-01 16:45:00&quot;,&quot;satelite&quot;:&quot;AQUA_M-T&quot;,&quot;pais&quot;:&quot;Brasil&quot;,&quot;estado&quot;:&quot;MATO GROSSO DO SUL&quot;,&quot;municipio&quot;:&quot;AMAMBAI&quot;,&quot;bioma&quot;:&quot;Mata Atlantica&quot;,&quot;diasemchuv&quot;:0,&quot;precipitac&quot;:0,&quot;riscofogo&quot;:0,&quot;latitude&quot;:-23.176,&quot;longitude&quot;:-54.727,&quot;frp&quot;:44.3},&quot;geometry&quot;:{&quot;type&quot;:&quot;Point&quot;,&quot;coordinates&quot;:[-54.727,-23.176]}}
{&quot;type&quot;:&quot;Feature&quot;,&quot;properties&quot;:{&quot;gid&quot;:249,&quot;datahora&quot;:&quot;2020-01-01 16:45:00&quot;,&quot;satelite&quot;:&quot;AQUA_M-T&quot;,&quot;pais&quot;:&quot;Brasil&quot;,&quot;estado&quot;:&quot;SAO PAULO&quot;,&quot;municipio&quot;:&quot;SAO ROQUE&quot;,&quot;bioma&quot;:&quot;Mata Atlantica&quot;,&quot;diasemchuv&quot;:0,&quot;precipitac&quot;:0,&quot;riscofogo&quot;:0,&quot;latitude&quot;:-23.487,&quot;longitude&quot;:-47.109,&quot;frp&quot;:7},&quot;geometry&quot;:{&quot;type&quot;:&quot;Point&quot;,&quot;coordinates&quot;:[-47.109,-23.487]}}
...
</pre></div>
</div>
<p>Agora estamos prontos para poder importar esse arquivo para o banco. Vamos então criar a tabela abaixo:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">focos_2020_json</span><span class="w"></span>
<span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">dados</span><span class="w"> </span><span class="n">JSONB</span><span class="w"></span>
<span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>Em seguida, podemos usar o metacomando <code class="docutils literal notranslate"><span class="pre">\copy</span></code> da seguinte forma:</p>
<div class="highlight-psql notranslate"><div class="highlight"><pre><span></span><span class="kp">\copy</span><span class="w"> </span><span class="ss">focos_2020_json</span><span class="w"> </span><span class="ss">FROM</span><span class="w"> </span><span class="ss">PROGRAM</span><span class="w"> </span><span class="s1">&#39;jq -c -r &#39;&#39;.features[]&#39;&#39; &lt; /data/json/focos.json&#39;</span><span class="ss">;</span>
</pre></div>
</div>
<p>Se todas as 2.283 linhas forem importadas sem problemas, o comando produzirá uma saída como:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>COPY 2283
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>No Microsoft Windows você pode utilizar o comando <code class="docutils literal notranslate"><span class="pre">\copy</span></code> de dentro do <em>psql</em>. Acesse o atalho desse aplicativo no grupo do PostgreSQL. Você terá que confirmar as informações de conexão ao seu banco de dados:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Server [localhost]:
Database [postgres]: bdgeo
Port [5432]:
Username [postgres]:
Password for user postgres:
</pre></div>
</div>
<p>Assim que a conexão estiver estabelecida, você deverá ter uma tela como:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>psql (14.5)
WARNING: Console code page (850) differs from Windows code page (1252)
         8-bit characters might not work correctly. See psql reference
         page &quot;Notes for Windows users&quot; for details.
Type &quot;help&quot; for help.

bdgeo=#
</pre></div>
</div>
<p>No <em>prompt</em> de comandos acima, entre com um comando como:</p>
<div class="highlight-psql notranslate"><div class="highlight"><pre><span></span><span class="kp">\copy</span><span class="w"> </span><span class="ss">focos_2020_json</span><span class="w"> </span><span class="ss">FROM</span><span class="w"> </span><span class="ss">PROGRAM</span><span class="w"> </span><span class="s1">&#39;c:\temp\jq-win64.exe -c -r &quot;.features[]&quot; &lt; c:\temp\focos.json&#39;</span><span class="ss">;</span>
</pre></div>
</div>
<p>Repare que no comando acima incluímos o caminho onde se encontram o aplictaivo <em>jq</em> e o arquivo JSON. Além disso, usamos aspas duplas (<code class="docutils literal notranslate"><span class="pre">&quot;</span></code>) para indicar a expressão de filtro (<code class="docutils literal notranslate"><span class="pre">&quot;.features[]&quot;</span></code>).</p>
</div>
<p>Para ver o resultado da importação, consulte a tabela <code class="docutils literal notranslate"><span class="pre">focos_2020_json</span></code>:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">focos_2020_json</span><span class="w"> </span><span class="k">LIMIT</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<p>Saída:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>                                                                                        dados
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {&quot;type&quot;: &quot;Feature&quot;, &quot;geometry&quot;: {&quot;type&quot;: &quot;Point&quot;, &quot;coordinates&quot;: [-54.732, -23.17]}, &quot;properties&quot;: {&quot;frp&quot;: 46.2, &quot;gid&quot;: 247, &quot;pais&quot;: &quot;Brasil&quot;, &quot;bioma&quot;: &quot;Mata Atlantica&quot;, &quot;estado&quot;: &quot;MATO GROSSO DO SUL&quot;, &quot;datahora&quot;: &quot;2020-01-01 16:45:00&quot;, &quot;latitude&quot;: -23.17, &quot;satelite&quot;: &quot;AQUA_M-T&quot;, &quot;longitude&quot;: -54.732, &quot;municipio&quot;: &quot;AMAMBAI&quot;, &quot;riscofogo&quot;: 0, &quot;diasemchuv&quot;: 0, &quot;precipitac&quot;: 0}}
 {&quot;type&quot;: &quot;Feature&quot;, &quot;geometry&quot;: {&quot;type&quot;: &quot;Point&quot;, &quot;coordinates&quot;: [-54.727, -23.176]}, &quot;properties&quot;: {&quot;frp&quot;: 44.3, &quot;gid&quot;: 248, &quot;pais&quot;: &quot;Brasil&quot;, &quot;bioma&quot;: &quot;Mata Atlantica&quot;, &quot;estado&quot;: &quot;MATO GROSSO DO SUL&quot;, &quot;datahora&quot;: &quot;2020-01-01 16:45:00&quot;, &quot;latitude&quot;: -23.176, &quot;satelite&quot;: &quot;AQUA_M-T&quot;, &quot;longitude&quot;: -54.727, &quot;municipio&quot;: &quot;AMAMBAI&quot;, &quot;riscofogo&quot;: 0, &quot;diasemchuv&quot;: 0, &quot;precipitac&quot;: 0}}
 {&quot;type&quot;: &quot;Feature&quot;, &quot;geometry&quot;: {&quot;type&quot;: &quot;Point&quot;, &quot;coordinates&quot;: [-47.109, -23.487]}, &quot;properties&quot;: {&quot;frp&quot;: 7, &quot;gid&quot;: 249, &quot;pais&quot;: &quot;Brasil&quot;, &quot;bioma&quot;: &quot;Mata Atlantica&quot;, &quot;estado&quot;: &quot;SAO PAULO&quot;, &quot;datahora&quot;: &quot;2020-01-01 16:45:00&quot;, &quot;latitude&quot;: -23.487, &quot;satelite&quot;: &quot;AQUA_M-T&quot;, &quot;longitude&quot;: -47.109, &quot;municipio&quot;: &quot;SAO ROQUE&quot;, &quot;riscofogo&quot;: 0, &quot;diasemchuv&quot;: 0, &quot;precipitac&quot;: 0}}
(3 rows)
</pre></div>
</div>
<section id="usando-indices-gin-com-o-tipo-jsonb">
<h2><span class="section-number">6.7.1. </span>Usando índices GIN com o tipo <code class="docutils literal notranslate"><span class="pre">jsonb</span></code><a class="headerlink" href="#usando-indices-gin-com-o-tipo-jsonb" title="Link permanente para este cabeçalho"></a></h2>
<p>Veja como a consulta abaixo é executa:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">EXPLAIN</span><span class="w"> </span><span class="k">ANALYZE</span><span class="w"></span>
<span class="w">    </span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"></span>
<span class="w">      </span><span class="k">FROM</span><span class="w"> </span><span class="n">focos_2020_json</span><span class="w"></span>
<span class="w">     </span><span class="k">WHERE</span><span class="w"> </span><span class="n">dados</span><span class="w"> </span><span class="o">@&gt;</span><span class="w"> </span><span class="s1">&#39;{&quot;properties&quot;: {&quot;bioma&quot;: &quot;Pampa&quot;}}&#39;</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<p>Saída:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>                                                  QUERY PLAN
--------------------------------------------------------------------------------------------------------------
 Seq Scan on focos_2020_json  (cost=0.00..171.54 rows=1 width=471) (actual time=0.112..3.627 rows=17
loops=1)
   Filter: (dados @&gt; &#39;{&quot;properties&quot;: {&quot;bioma&quot;: &quot;Pampa&quot;}}&#39;::jsonb)
   Rows Removed by Filter: 2266
 Planning Time: 0.490 ms
 Execution Time: 3.664 ms
(5 rows)

Time: 4.793 ms
</pre></div>
</div>
<p>Agora, vamos criar um índice GIN sobre a coluna <code class="docutils literal notranslate"><span class="pre">dados</span></code>:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">focos_2020_json_dados_idx</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">focos_2020_json</span><span class="w"> </span><span class="k">USING</span><span class="w"> </span><span class="n">GIN</span><span class="w"> </span><span class="p">(</span><span class="n">dados</span><span class="p">);</span><span class="w"></span>

<span class="k">ANALYZE</span><span class="w"> </span><span class="n">focos_2020_json</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<p>Refazendo a análise da consulta, obteremos:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">EXPLAIN</span><span class="w"> </span><span class="k">ANALYZE</span><span class="w"></span>
<span class="w">    </span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"></span>
<span class="w">      </span><span class="k">FROM</span><span class="w"> </span><span class="n">focos_2020_json</span><span class="w"></span>
<span class="w">     </span><span class="k">WHERE</span><span class="w"> </span><span class="n">dados</span><span class="w"> </span><span class="o">@&gt;</span><span class="w"> </span><span class="s1">&#39;{&quot;properties&quot;: {&quot;bioma&quot;: &quot;Pampa&quot;}}&#39;</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<p>Saída:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>                                                             QUERY PLAN
------------------------------------------------------------------------------------------------------------------------------------
 Bitmap Heap Scan on focos_2020_json  (cost=28.00..32.01 rows=1 width=471) (actual time=0.153..0.218 rows=17 loops=1)
   Recheck Cond: (dados @&gt; &#39;{&quot;properties&quot;: {&quot;bioma&quot;: &quot;Pampa&quot;}}&#39;::jsonb)
   Heap Blocks: exact=12
   -&gt;  Bitmap Index Scan on focos_2020_json_dados_idx  (cost=0.00..28.00 rows=1 width=0) (actual time=0.128..0.129 rows=17 loops=1)
         Index Cond: (dados @&gt; &#39;{&quot;properties&quot;: {&quot;bioma&quot;: &quot;Pampa&quot;}}&#39;::jsonb)
 Planning Time: 0.904 ms
 Execution Time: 0.288 ms
(7 rows)

Time: 2.109 ms
</pre></div>
</div>
</section>
<section id="dicas">
<h2><span class="section-number">6.7.2. </span>Dicas<a class="headerlink" href="#dicas" title="Link permanente para este cabeçalho"></a></h2>
<p><strong>1.</strong> Se você quiser selecionar os objetos que representam geometrias nos dados JSON, utilize o opetrador <code class="docutils literal notranslate"><span class="pre">-&gt;</span></code> como mostrado abaixo:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">dados</span><span class="o">-&gt;</span><span class="s1">&#39;geometry&#39;</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">focos_2020_json</span><span class="w"> </span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<p><strong>2.</strong> Para transformar o objeto GeoJSON em uma geometria do PostGIS, use a função <code class="docutils literal notranslate"><span class="pre">ST_GeomFromGeoJSON</span></code>, como mostrado abaixo:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">ST_GeomFromGeoJSON</span><span class="p">(</span><span class="n">dados</span><span class="o">-&gt;</span><span class="s1">&#39;geometry&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">focos_2020_json</span><span class="w"> </span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<p><strong>3.</strong> Para gerar um único objeto JSON contendo tanto as propriedades alfanuméricas quanto a geometria, use a função <code class="docutils literal notranslate"><span class="pre">jsonb_insert</span></code> como mostrado abaixo:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">jsonb_insert</span><span class="p">(</span><span class="n">dados</span><span class="o">-&gt;</span><span class="s1">&#39;properties&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;{geom}&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">dados</span><span class="o">-&gt;</span><span class="s1">&#39;geometry&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">focos_2020_json</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<p><strong>4.</strong> Para transformar os objetos JSON em uma tabela convencional, crie uma tabela com a seguinte estrutura:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">foco_2020_v2</span><span class="w"></span>
<span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">gid</span><span class="w">          </span><span class="nb">INTEGER</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">datahora</span><span class="w">     </span><span class="k">TIMESTAMP</span><span class="w"> </span><span class="k">WITHOUT</span><span class="w"> </span><span class="k">TIME</span><span class="w"> </span><span class="k">ZONE</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">satelite</span><span class="w">     </span><span class="nb">CHARACTER</span><span class="w"> </span><span class="nb">VARYING</span><span class="p">(</span><span class="mi">80</span><span class="p">),</span><span class="w"></span>
<span class="w">    </span><span class="n">pais</span><span class="w">         </span><span class="nb">CHARACTER</span><span class="w"> </span><span class="nb">VARYING</span><span class="p">(</span><span class="mi">80</span><span class="p">),</span><span class="w"></span>
<span class="w">    </span><span class="n">estado</span><span class="w">       </span><span class="nb">CHARACTER</span><span class="w"> </span><span class="nb">VARYING</span><span class="p">(</span><span class="mi">80</span><span class="p">),</span><span class="w"></span>
<span class="w">    </span><span class="n">municipio</span><span class="w">    </span><span class="nb">CHARACTER</span><span class="w"> </span><span class="nb">VARYING</span><span class="p">(</span><span class="mi">80</span><span class="p">),</span><span class="w"></span>
<span class="w">    </span><span class="n">bioma</span><span class="w">        </span><span class="nb">CHARACTER</span><span class="w"> </span><span class="nb">VARYING</span><span class="p">(</span><span class="mi">80</span><span class="p">),</span><span class="w"></span>
<span class="w">    </span><span class="n">diasemchuv</span><span class="w">   </span><span class="nb">INTEGER</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">precipitac</span><span class="w">   </span><span class="nb">NUMERIC</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">riscofogo</span><span class="w">    </span><span class="nb">NUMERIC</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">latitude</span><span class="w">     </span><span class="nb">NUMERIC</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">longitude</span><span class="w">    </span><span class="nb">NUMERIC</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">frp</span><span class="w">          </span><span class="nb">NUMERIC</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">geom</span><span class="w">         </span><span class="n">GEOMETRY</span><span class="p">(</span><span class="n">POINT</span><span class="p">,</span><span class="mi">4326</span><span class="p">)</span><span class="w"></span>
<span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>Em seguida, importe os dados para essa tabela usando a função <code class="docutils literal notranslate"><span class="pre">jsonb_populate_record</span></code>:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">foco_2020_v2</span><span class="w"></span>
<span class="w">    </span><span class="k">SELECT</span><span class="w"> </span><span class="p">(</span><span class="n">jsonb_populate_record</span><span class="p">(</span><span class="k">NULL</span><span class="p">::</span><span class="n">foco_2020_v2</span><span class="p">,</span><span class="w"> </span><span class="n">jsonb_insert</span><span class="p">(</span><span class="n">dados</span><span class="o">-&gt;</span><span class="s1">&#39;properties&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;{geom}&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">dados</span><span class="o">-&gt;</span><span class="s1">&#39;geometry&#39;</span><span class="p">))).</span><span class="o">*</span><span class="w"></span>
<span class="w">      </span><span class="k">FROM</span><span class="w"> </span><span class="n">focos_2020_json</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Rodapé">
        <a href="json.html" class="btn btn-neutral float-left" title="6.6. O Tipo JSON no PostgreSQL" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Anterior</a>
        <a href="../prog-servidor/index.html" class="btn btn-neutral float-right" title="7. Programação do Lado Servidor no PostgreSQL" accesskey="n" rel="next">Próximo <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020-2022, Gilberto Queiroz.</p>
  </div>

  
<jinja2.runtime.BlockReference object at 0x7f46dc3d2d00>
<a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://mirrors.creativecommons.org/presskit/buttons/88x31/png/by-nc-sa.png" width="117" height="41"/></a> This work is licensed under a <a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">Creative Commons “Attribution-NonCommercial-ShareAlike 4.0 International” license</a>.


</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(false);
      });
  </script>
    <!-- Theme Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-165908761-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-165908761-1', {
          'anonymize_ip': false,
      });
    </script> 

</body>
</html>